<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>考研英语单词闪动记忆系统</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: #333;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .container {
            max-width: 1000px;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            padding: 30px;
            margin-top: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.2rem;
        }
        
        .description {
            color: #555;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .control-panel {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 25px;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }
        
        .control-group {
            flex: 1;
            min-width: 200px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
        }
        
        input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .value-display {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            color: #666;
        }
        
        .word-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        select {
            padding: 8px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: white;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .primary-btn {
            background-color: #3498db;
            color: white;
        }
        
        .primary-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .secondary-btn {
            background-color: #e74c3c;
            color: white;
        }
        
        .secondary-btn:hover {
            background-color: #c0392b;
            transform: translateY(-2px);
        }
        
        .success-btn {
            background-color: #2ecc71;
            color: white;
        }
        
        .success-btn:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
        }
        
        .display-area {
            height: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #2c3e50, #4a6491);
            border-radius: 10px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.3);
        }
        
        .flash-content {
            font-size: 36px;
            color: white;
            text-align: center;
            font-weight: bold;
            padding: 20px;
            transition: opacity 0.1s;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .word-details {
            margin-top: 10px;
            font-size: 18px;
            color: #ecf0f1;
        }
        
        .phonetic {
            font-style: italic;
            margin-bottom: 10px;
        }
        
        .example {
            font-size: 16px;
            margin-top: 5px;
            font-style: italic;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            color: #555;
            font-size: 14px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }
        
        .word-count {
            font-weight: bold;
            color: #3498db;
        }
        
        .progress-bar {
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: #3498db;
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        .word-info {
            text-align: center;
            margin-top: 10px;
            color: #7f8c8d;
            font-style: italic;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: #2ecc71;
            color: white;
            border-radius: 5px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        @media (max-width: 768px) {
            .control-panel {
                flex-direction: column;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
            
            .word-filter {
                flex-direction: column;
            }
            
            .display-area {
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>考研英语单词闪动记忆系统</h1>
            <p class="description">基于闪动记忆法原理，通过快速呈现单词和释义增强记忆效果。系统包含完整考研英语词汇库，助您高效备考。</p>
        </header>
        
        <div class="word-filter">
            <div class="filter-group">
                <label>词频筛选：</label>
                <select id="frequency-filter">
                    <option value="all">全部词汇</option>
                    <option value="high">高频词汇</option>
                    <option value="medium">中频词汇</option>
                    <option value="low">低频词汇</option>
                </select>
            </div>
            <div class="filter-group">
                <label>字母筛选：</label>
                <select id="letter-filter">
                    <option value="all">全部字母</option>
                    <option value="a">A</option>
                    <option value="b">B</option>
                    <option value="c">C</option>
                    <option value="d">D</option>
                    <option value="e">E</option>
                    <option value="f">F</option>
                    <option value="g">G</option>
                    <option value="h">H</option>
                    <option value="i">I</option>
                    <option value="j">J</option>
                    <option value="k">K</option>
                    <option value="l">L</option>
                    <option value="m">M</option>
                    <option value="n">N</option>
                    <option value="o">O</option>
                    <option value="p">P</option>
                    <option value="q">Q</option>
                    <option value="r">R</option>
                    <option value="s">S</option>
                    <option value="t">T</option>
                    <option value="u">U</option>
                    <option value="v">V</option>
                    <option value="w">W</option>
                    <option value="x">X</option>
                    <option value="y">Y</option>
                    <option value="z">Z</option>
                </select>
            </div>
            <div class="filter-group">
                <label>词性筛选：</label>
                <select id="pos-filter">
                    <option value="all">全部词性</option>
                    <option value="n">名词</option>
                    <option value="v">动词</option>
                    <option value="adj">形容词</option>
                    <option value="adv">副词</option>
                    <option value="prep">介词</option>
                    <option value="conj">连词</option>
                </select>
            </div>
        </div>
        
        <div class="control-panel">
            <div class="control-group">
                <label for="speed-control">闪动速度</label>
                <input type="range" id="speed-control" min="50" max="1000" value="300">
                <div class="value-display">
                    <span>慢</span>
                    <span id="speed-value">300 毫秒/词</span>
                    <span>快</span>
                </div>
            </div>
            
            <div class="control-group">
                <label for="batch-control">每次显示数量</label>
                <input type="number" id="batch-control" min="1" max="5" value="1">
            </div>
            
            <div class="control-group">
                <label for="font-size-control">字体大小</label>
                <input type="range" id="font-size-control" min="20" max="60" value="36">
                <div class="value-display">
                    <span>小</span>
                    <span id="font-size-value">36px</span>
                    <span>大</span>
                </div>
            </div>
        </div>
        
        <div class="button-group">
            <button id="start-btn" class="primary-btn">开始记忆</button>
            <button id="pause-btn" class="secondary-btn">暂停</button>
            <button id="reset-btn" class="success-btn">重置</button>
            <button id="random-btn" class="primary-btn">随机顺序</button>
            <button id="show-details-btn" class="primary-btn">显示详情</button>
        </div>
        
        <div class="display-area">
            <div id="flash-content" class="flash-content">
                <div>准备开始记忆考研英语单词</div>
            </div>
        </div>
        
        <div class="word-info" id="word-info">系统正在加载单词库...</div>
        
        <div class="stats">
            <div>当前进度: <span id="current-progress">0/0</span></div>
            <div>已用时: <span id="time-elapsed">0秒</span></div>
            <div>今日已学: <span id="today-count">0</span> 词</div>
        </div>
        
        <div class="progress-bar">
            <div class="progress" id="progress-bar" style="width: 0%"></div>
        </div>
    </div>

    <div class="notification" id="notification">操作成功！</div>

    <script>
        // 全局变量
        let vocabularyData = [];
        let isPlaying = false;
        let currentIndex = 0;
        let timer = null;
        let startTime = null;
        let elapsedTime = 0;
        let filteredItems = [];
        let isRandomOrder = false;
        let showDetails = false;

        // DOM元素
        const frequencyFilter = document.getElementById('frequency-filter');
        const letterFilter = document.getElementById('letter-filter');
        const posFilter = document.getElementById('pos-filter');
        const speedControl = document.getElementById('speed-control');
        const batchControl = document.getElementById('batch-control');
        const fontSizeControl = document.getElementById('font-size-control');
        const startBtn = document.getElementById('start-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const resetBtn = document.getElementById('reset-btn');
        const randomBtn = document.getElementById('random-btn');
        const showDetailsBtn = document.getElementById('show-details-btn');
        const flashContent = document.getElementById('flash-content');
        const currentProgress = document.getElementById('current-progress');
        const timeElapsed = document.getElementById('time-elapsed');
        const todayCount = document.getElementById('today-count');
        const speedValue = document.getElementById('speed-value');
        const fontSizeValue = document.getElementById('font-size-value');
        const wordInfo = document.getElementById('word-info');
        const progressBar = document.getElementById('progress-bar');
        const notification = document.getElementById('notification');

        // 初始化
        async function init() {
            // 事件监听
            startBtn.addEventListener('click', startFlashing);
            pauseBtn.addEventListener('click', pauseFlashing);
            resetBtn.addEventListener('click', resetFlashing);
            randomBtn.addEventListener('click', toggleRandomOrder);
            showDetailsBtn.addEventListener('click', toggleDetails);
            speedControl.addEventListener('input', updateSpeedDisplay);
            fontSizeControl.addEventListener('input', updateFontSize);
            frequencyFilter.addEventListener('change', applyFilters);
            letterFilter.addEventListener('change', applyFilters);
            posFilter.addEventListener('change', applyFilters);
            
            // 初始化显示
            updateSpeedDisplay();
            updateFontSize();
            
            // 加载单词数据
            await loadVocabularyData();
            
            // 应用初始筛选
            applyFilters();
            
            // 初始化今日计数
            initTodayCount();
        }

        // 加载单词数据
        async function loadVocabularyData() {
            try {
                wordInfo.textContent = "正在加载单词库...";
                
                // 替换为您的JSON文件路径
                // 如果JSON文件与HTML文件在同一目录下，可以使用相对路径
                const response = await fetch('./kaoyan_vocabulary.json');
                
                if (!response.ok) {
                    throw new Error('网络响应不正常');
                }
                
                vocabularyData = await response.json();
                showNotification(`单词库加载成功，共 ${vocabularyData.length} 个单词`);
                wordInfo.textContent = `单词库加载成功，共 ${vocabularyData.length} 个单词`;
            } catch (error) {
                console.error('加载单词数据失败:', error);
                showNotification('加载单词库失败，使用示例数据');
                wordInfo.textContent = "加载单词库失败，使用示例数据";
                
                // 使用示例数据作为后备
                vocabularyData = getSampleVocabulary();
            }
        }

        // 示例单词数据（后备方案）
        function getSampleVocabulary() {
            return [
                {
                    word: "abandon",
                    meaning: "v. 放弃，抛弃",
                    frequency: "high",
                    pos: "v",
                    phonetic: "/əˈbændən/",
                    examples: ["He abandoned his family.", "They abandoned the project due to lack of funds."]
                },
                {
                    word: "ability",
                    meaning: "n. 能力，才能",
                    frequency: "high",
                    pos: "n",
                    phonetic: "/əˈbɪləti/",
                    examples: ["She has the ability to speak five languages.", "His mathematical ability is impressive."]
                },
                {
                    word: "abnormal",
                    meaning: "adj. 反常的，异常的",
                    frequency: "high",
                    pos: "adj",
                    phonetic: "/æbˈnɔːrml/",
                    examples: ["The test results were abnormal.", "Such behavior is abnormal for a child of that age."]
                },
                {
                    word: "abolish",
                    meaning: "v. 废除，取消",
                    frequency: "high",
                    pos: "v",
                    phonetic: "/əˈbɒlɪʃ/",
                    examples: ["Slavery was abolished in the 19th century.", "They plan to abolish the old system."]
                },
                {
                    word: "abroad",
                    meaning: "adv. 在国外，到国外",
                    frequency: "high",
                    pos: "adv",
                    phonetic: "/əˈbrɔːd/",
                    examples: ["She studied abroad for two years.", "He travels abroad frequently for business."]
                }
            ];
        }

        // 应用筛选条件
        function applyFilters() {
            const frequency = frequencyFilter.value;
            const letter = letterFilter.value;
            const pos = posFilter.value;
            
            filteredItems = vocabularyData.filter(item => {
                // 词频筛选
                if (frequency !== 'all' && item.frequency !== frequency) {
                    return false;
                }
                
                // 字母筛选
                if (letter !== 'all' && !item.word.toLowerCase().startsWith(letter)) {
                    return false;
                }
                
                // 词性筛选
                if (pos !== 'all' && !item.pos.includes(pos)) {
                    return false;
                }
                
                return true;
            });
            
            // 更新统计信息
            updateStats();
            
            // 重置进度
            resetProgress();
        }

        // 更新统计信息
        function updateStats() {
            wordInfo.textContent = `已筛选 ${filteredItems.length} 个单词`;
            currentProgress.textContent = `0/${filteredItems.length}`;
            progressBar.style.width = '0%';
        }

        // 更新速度显示
        function updateSpeedDisplay() {
            speedValue.textContent = `${speedControl.value} 毫秒/词`;
        }

        // 更新字体大小
        function updateFontSize() {
            const size = fontSizeControl.value;
            fontSizeValue.textContent = `${size}px`;
            flashContent.style.fontSize = `${size}px`;
        }

        // 开始闪动
        function startFlashing() {
            if (isPlaying) return;
            
            if (filteredItems.length === 0) {
                showNotification('请先选择筛选条件！');
                return;
            }
            
            isPlaying = true;
            startTime = new Date();
            currentIndex = 0;
            
            // 如果是随机顺序，打乱数组
            if (isRandomOrder) {
                shuffleArray(filteredItems);
            }
            
            timer = setInterval(flashNext, parseInt(speedControl.value));
            
            // 更新时间显示
            setInterval(updateTime, 1000);
            
            showNotification('开始记忆单词');
        }

        // 闪动下一个项目
        function flashNext() {
            if (currentIndex >= filteredItems.length) {
                pauseFlashing();
                flashContent.innerHTML = "<div>已完成所有单词！</div>";
                updateTodayCount();
                showNotification('恭喜！已完成所有单词');
                return;
            }
            
            const batchSize = parseInt(batchControl.value);
            const batchItems = filteredItems.slice(currentIndex, currentIndex + batchSize);
            
            let displayText = '';
            batchItems.forEach(item => {
                displayText += `<div style="margin-bottom: 10px;">${item.word}</div>`;
                
                if (showDetails) {
                    displayText += `<div class="word-details">`;
                    displayText += `<div class="phonetic">${item.phonetic}</div>`;
                    displayText += `<div style="margin-bottom: 10px;">${item.meaning}</div>`;
                    if (item.examples && item.examples.length > 0) {
                        displayText += `<div class="example">${item.examples[0]}</div>`;
                    }
                    displayText += `</div>`;
                } else {
                    displayText += `<div style="margin-bottom: 15px;">${item.meaning}</div>`;
                }
            });
            
            flashContent.innerHTML = displayText;
            
            currentIndex += batchSize;
            currentProgress.textContent = `${Math.min(currentIndex, filteredItems.length)}/${filteredItems.length}`;
            
            // 更新进度条
            const progress = (currentIndex / filteredItems.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // 暂停闪动
        function pauseFlashing() {
            isPlaying = false;
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            showNotification('已暂停');
        }

        // 重置闪动
        function resetFlashing() {
            pauseFlashing();
            currentIndex = 0;
            elapsedTime = 0;
            flashContent.innerHTML = "<div>准备开始记忆考研英语单词</div>";
            currentProgress.textContent = `0/${filteredItems.length}`;
            timeElapsed.textContent = "0秒";
            progressBar.style.width = '0%';
            showNotification('已重置');
        }

        // 切换随机顺序
        function toggleRandomOrder() {
            isRandomOrder = !isRandomOrder;
            randomBtn.textContent = isRandomOrder ? "顺序模式" : "随机模式";
            randomBtn.style.backgroundColor = isRandomOrder ? "#9b59b6" : "#3498db";
            
            if (isRandomOrder) {
                shuffleArray(filteredItems);
                showNotification('已切换到随机模式');
            } else {
                // 恢复原始顺序
                applyFilters();
                showNotification('已切换到顺序模式');
            }
            
            resetProgress();
        }

        // 切换显示详情
        function toggleDetails() {
            showDetails = !showDetails;
            showDetailsBtn.textContent = showDetails ? "隐藏详情" : "显示详情";
            showDetailsBtn.style.backgroundColor = showDetails ? "#9b59b6" : "#3498db";
            
            if (isPlaying) {
                // 如果正在播放，立即更新显示
                flashNext();
            }
            
            showNotification(showDetails ? '显示单词详情' : '隐藏单词详情');
        }

        // 重置进度
        function resetProgress() {
            currentIndex = 0;
            currentProgress.textContent = `0/${filteredItems.length}`;
            progressBar.style.width = '0%';
        }

        // 更新时间显示
        function updateTime() {
            if (isPlaying && startTime) {
                const now = new Date();
                elapsedTime = Math.floor((now - startTime) / 1000);
                timeElapsed.textContent = `${elapsedTime}秒`;
            }
        }

        // 初始化今日计数
        function initTodayCount() {
            const today = new Date().toDateString();
            const storedDate = localStorage.getItem('lastStudyDate');
            let count = parseInt(localStorage.getItem('todayCount') || '0');
            
            if (storedDate !== today) {
                count = 0;
                localStorage.setItem('lastStudyDate', today);
            }
            
            todayCount.textContent = count;
        }

        // 更新今日已学计数
        function updateTodayCount() {
            const today = new Date().toDateString();
            const storedDate = localStorage.getItem('lastStudyDate');
            let count = parseInt(localStorage.getItem('todayCount') || '0');
            
            if (storedDate !== today) {
                count = 0;
                localStorage.setItem('lastStudyDate', today);
            }
            
            count += filteredItems.length;
            localStorage.setItem('todayCount', count.toString());
            todayCount.textContent = count;
        }

        // 显示通知
        function showNotification(message) {
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // 打乱数组顺序
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // 初始化应用
        window.onload = init;
    </script>
</body>
</html>
